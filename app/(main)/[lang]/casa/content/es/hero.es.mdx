"use client";

import CardParallax from "@/components/mdx/CardParallax";
import Reveal from "@/components/scroll/Reveal";
import Image from "next/image";

export default function CasaHeroES() {
  return (
    <section
      id="hero"
      className="
        relative w-full mx-auto
        md:max-w-none md:w-full
        -mt-2 flex items-center justify-center pb-0
      "
    >
      <div
        className="
          relative
          md:!max-w-none md:!w-[min(1600px,calc(100vw-var(--dock-left,220px)-var(--dock-right,96px)-48px))]
          w-full
          h-[calc(100dvh-var(--header-h,64px)-var(--mobile-nav-h,84px)+24px)]
          md:h-[calc(100svh-var(--header-h,112px)-56px)]
          xl:max-h-[960px]
          hero-pill shadow-[0_20px_60px_-20px_rgba(0,0,0,0.35)]
        "
      >
        <CardParallax
          src="/images/casa/hero.jpg"
          alt="Casa Olivea"
          speed={0.3}
          surfaceClassName="h-full w-full"
          className="-inset-[1px]"
          fit="cover"
          objectPosition="50% 40%"
          priority
          quality={58}
          placeholder="empty"
          sizes="(max-width: 768px) 100vw, min(1600px, calc(100vw - var(--dock-left,220px) - var(--dock-right,96px) - 48px))"
        />

        <div className="absolute inset-0 pointer-events-none">
          <div className="absolute inset-0 bg-gradient-to-t from-black/55 via-black/25 to-transparent" />
          <h1 className="sr-only">Casa Olivea</h1>

          <div className="relative h-full flex items-center justify-center">
            <div
              className="
                pointer-events-auto text-center px-4
                relative

                /* center relative to full viewport */
                md:[left:calc((var(--dock-right,120px)-var(--dock-left,264px))/2)]

                flex flex-col items-center

                /* ðŸ”¥ Reduced vertical rhythm */
                gap-[10px] md:gap-[14px] lg:gap-[16px]

                -mt-2

                /* vertical lift */
                md:[top:calc(-1*clamp(18px,4vh,72px))]
                lg:[top:calc(-1*clamp(22px,5vh,96px))]

                max-w-[min(92vw,560px)] md:max-w-none mx-auto
              "
            >
              {/* Logo (larger on mobile + desktop) */}
              <Reveal preset="fade" delay={0.05}>
                <div
                  className="
                    relative

                    /* ðŸ”¥ Mobile larger */
                    w-[clamp(170px,34vw,240px)]
                    h-[clamp(170px,34vw,240px)]

                    /* ðŸ”¥ Desktop larger */
                    md:w-[clamp(230px,15vw,320px)]
                    md:h-[clamp(230px,15vw,320px)]

                    lg:w-[clamp(260px,13vw,360px)]
                    lg:h-[clamp(260px,13vw,360px)]
                  "
                >
                  <Image
                    src="/brand/herocasa.svg"
                    alt="Casa Olivea"
                    fill
                    sizes="(max-width: 640px) 240px, (max-width: 1024px) 320px, 360px"
                    className="object-contain"
                    priority={false}
                  />
                </div>
              </Reveal>

              {/* Slogan (pulled slightly upward) */}
              <Reveal preset="up" delay={0.12}>
                <div className="w-full text-center -mt-2 md:-mt-3">
                  {/* Mobile (bigger) */}
                  <span
                    className="
                      md:hidden
                      inline-block whitespace-nowrap leading-tight
                      font-serif italic uppercase text-white/95
                      tracking-[0.06em]
                      text-[clamp(14px,3.6vw,17px)]
                      drop-shadow-[0_1px_3px_rgba(0,0,0,0.5)]
                    "
                  >
                    Donde el huerto es la esencia
                  </span>
                  <span className="mt-1 h-[1px] w-20 bg-white/35 md:hidden block mx-auto" />

                  {/* Desktop */}
                  <span className="hidden md:inline-flex items-center md:gap-4 md:[--rule:2.5rem] lg:[--rule:3.5rem]">
                    <span className="md:flex-none md:h-px md:w-[var(--rule)] bg-white/30" />
                    <span
                      className="
                        inline-block leading-tight md:whitespace-nowrap
                        font-serif italic uppercase text-white/95
                        tracking-[0.14em] md:text-base lg:text-lg
                        drop-shadow-[0_1px_3px_rgba(0,0,0,0.5)]
                      "
                    >
                      Donde el huerto es la esencia
                    </span>
                    <span className="md:flex-none md:h-px md:w-[var(--rule)] bg-white/30" />
                  </span>
                </div>
              </Reveal>

              {/* Buttons */}
              <Reveal preset="fade" delay={0.18}>
                <div className="flex items-center justify-center gap-2 md:gap-3 pb-[max(0px,env(safe-area-inset-bottom))]">
                  <button
                    type="button"
                    aria-label="Reservar una habitaciÃ³n"
                    data-reserve-intent
                    onPointerEnter={() => {
                      window.dispatchEvent(new Event("olivea:reserve-intent"));
                    }}
                    onClick={() => {
                      window.dispatchEvent(new Event("olivea:reserve"));
                    }}
                    className="
                      inline-flex items-center justify-center
                      rounded-full px-3.5 py-1.5 text-[15px]
                      md:px-5 md:py-2.5 md:text-base
                      lg:px-6 lg:py-3   lg:text-[17px]
                      font-medium tracking-wide
                      text-white/90 border border-white/35 bg-white/[0.01] backdrop-blur-[2px]
                      shadow-[0_2px_12px_-8px_rgba(0,0,0,0.45)]
                      transition hover:bg-white/8 hover:text-white
                      focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50
                      active:scale-[0.98]
                    "
                  >
                    RESERVAR
                  </button>

                  <a
                    href="#servicios"
                    aria-label="Ver servicios"
                    onClick={(e) => {
                      e.preventDefault();
                      const el =
                        document.getElementById("servicios") ||
                        document.querySelector(".main-section#servicios");
                      if (!el) return;
                      const v = getComputedStyle(document.documentElement).getPropertyValue("--header-h");
                      const header = Number.parseInt(v || "64", 10) || 64;
                      const top = window.scrollY + el.getBoundingClientRect().top - header - 8;
                      window.scrollTo({ top, behavior: "smooth" });
                      if (window.location.hash.slice(1) !== "servicios")
                        history.replaceState(null, "", "#servicios");
                    }}
                    className="
                      inline-flex items-center justify-center
                      rounded-full px-3.5 py-1.5 text-[15px]
                      md:px-5 md:py-2.5 md:text-base
                      lg:px-6 lg:py-3   lg:text-[17px]
                      font-medium tracking-wide
                      text-white/80 border border-white/30 bg-white/[0.01] backdrop-blur-[2px]
                      shadow-[0_2px_12px_-8px_rgba(0,0,0,0.45)]
                      transition hover:bg-white/6 hover:text-white
                      focus:outline-none focus-visible:ring-2 focus-visible:ring-white/40
                      active:scale-[0.98]
                    "
                  >
                    Servicios
                  </a>
                </div>
              </Reveal>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}